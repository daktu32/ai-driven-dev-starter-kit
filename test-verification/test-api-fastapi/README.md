# test-api-fastapi

test-api-fastapi - Generated by Claude Code Dev Starter Kit

## 機能

- FastAPI 0.104+ 完全対応
- Pydantic v2 データバリデーション
- 自動OpenAPI/Swagger UI生成
- 非同期処理対応
- SQLAlchemy 2.0+ データベース統合
- JWT認証サポート
- CORS設定済み
- 型ヒント完全対応

## クイックスタート

### 必要な環境

- Python 3.8以上
- pip または poetry

### インストール

```bash
# 仮想環境を作成
python -m venv venv

# 仮想環境を有効化
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# 依存関係をインストール
pip install -r requirements.txt
```

### 開発サーバー起動

```bash
# 基本的な起動方法
uvicorn src.main:app --reload

# または直接実行
python src/main.py
```

サーバーが http://localhost:8000 で起動します。

### API確認

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **Health Check**: http://localhost:8000/health

## API エンドポイント

### 基本エンドポイント

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/` | ルートエンドポイント |
| GET | `/health` | ヘルスチェック |
| GET | `/api/info` | API情報取得 |

### アイテム管理

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/items` | 全アイテム取得 |
| GET | `/items/{id}` | 特定アイテム取得 |
| POST | `/items` | アイテム作成 |
| PUT | `/items/{id}` | アイテム更新 |
| DELETE | `/items/{id}` | アイテム削除 |

### リクエスト例

```bash
# 全アイテム取得
curl http://localhost:8000/items

# アイテム作成
curl -X POST http://localhost:8000/items \
  -H "Content-Type: application/json" \
  -d '{"name": "新しいアイテム", "description": "説明文"}'

# 特定アイテム取得
curl http://localhost:8000/items/1
```

## 開発

### プロジェクト構造

```
test-api-fastapi/
├── src/
│   └── main.py              # メインアプリケーション
├── tests/                   # テストファイル
├── requirements.txt         # 依存関係
├── pyproject.toml          # プロジェクト設定
└── README.md               # このファイル
```

### 開発コマンド

```bash
# 開発サーバー（ホットリロード）
uvicorn src.main:app --reload --host 0.0.0.0 --port 8000

# テスト実行
pytest

# コードフォーマット
black src/
isort src/

# 型チェック
mypy src/

# リンティング
flake8 src/
```

### カスタマイズ

1. **データモデル**: `src/main.py`のPydanticモデルを編集
2. **エンドポイント**: 新しいルートを`src/main.py`に追加
3. **データベース**: SQLAlchemyモデルを追加（別ファイル推奨）
4. **認証**: JWT認証の実装を追加

### データベース設定

現在はメモリ内ストレージを使用しています。本格的なデータベースを使用する場合：

```bash
# PostgreSQL
pip install psycopg2-binary

# MongoDB
pip install pymongo

# Redis
pip install redis
```

### 環境変数

`.env`ファイルを作成して設定：

```env
# データベース
DATABASE_URL=postgresql://user:password@localhost/dbname

# セキュリティ
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# CORS
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
```

## テスト

```bash
# 全テスト実行
pytest

# カバレッジ付きテスト
pytest --cov=src

# 特定テストファイル実行
pytest tests/test_main.py

# テスト詳細表示
pytest -v
```

## デプロイ

### Docker

```bash
# Dockerfileを作成後
docker build -t test-api-fastapi .
docker run -p 8000:8000 test-api-fastapi
```

### Heroku

```bash
# Procfileを作成: web: uvicorn src.main:app --host=0.0.0.0 --port=${PORT:-5000}
heroku create test-api-fastapi
git push heroku main
```

### その他のプラットフォーム

- **Railway**: `requirements.txt`とメインファイルを配置
- **Vercel**: `vercel.json`設定を追加
- **AWS Lambda**: Mangumを使用してASGI対応

## トラブルシューティング

### よくある問題

1. **モジュールが見つからない**
   ```bash
   pip install -r requirements.txt
   ```

2. **ポートが使用中**
   ```bash
   uvicorn src.main:app --port 8001
   ```

3. **CORS エラー**
   - `main.py`のCORSミドルウェア設定を確認

## パフォーマンス最適化

- **非同期処理**: `async/await`を活用
- **データベース**: SQLAlchemyの最適化
- **キャッシュ**: Redisを使用
- **ロードバランシング**: Gunicorn + Uvicornワーカー

## セキュリティ

- **入力バリデーション**: Pydanticによる自動バリデーション
- **認証**: JWT実装推奨
- **HTTPS**: プロダクションでは必須
- **レート制限**: slowapiライブラリ推奨

## 技術スタック

- **フレームワーク**: FastAPI 0.104+
- **ASGI**: Uvicorn
- **バリデーション**: Pydantic v2
- **ORM**: SQLAlchemy 2.0
- **マイグレーション**: Alembic
- **テスト**: pytest + pytest-asyncio
- **フォーマット**: Black + isort

## ライセンス

MIT License

## 作成者

Your Name

---

素晴らしいAPIを構築してください！